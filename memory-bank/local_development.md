# Local Development Setup

This document outlines the necessary steps for setting up a local development environment that can successfully handle OAuth authentication with external services like Yahoo.

## Local Development with HTTPS (using `mkcert`)

For local development, especially when dealing with OAuth providers like Yahoo that require HTTPS callback URLs, it's best to use a locally trusted SSL certificate. `mkcert` is a tool that simplifies the creation of such certificates.

### Steps to Set up `mkcert` and Run Backend with HTTPS

1.  **Install `mkcert` (One-time setup):**
    *   Open your terminal.
    *   Install `mkcert` using Homebrew (if you don't have Homebrew, install it first from `https://brew.sh/`):
        ```bash
        brew install mkcert
        ```
    *   Install a local CA (Certificate Authority) with `mkcert`. This makes the certificates generated by `mkcert` trusted by your browser:
        ```bash
        mkcert -install
        ```
        *Note: These steps may require administrator privileges or your macOS user password.*

2.  **Generate Certificates for `localhost`:**
    *   Create a directory to store your certificates within your `backend` folder:
        ```bash
        mkdir -p backend/certs
        ```
    *   Generate the SSL certificate and key for `localhost` and place them in `backend/certs`:
        ```bash
        mkcert -key-file backend/certs/localhost-key.pem -cert-file backend/certs/localhost.pem localhost 127.0.0.1 ::1
        ```
        *Note: Add `backend/certs/` to your `.gitignore` file to prevent these sensitive files from being committed to Git.*

3.  **Configure Flask Backend for HTTPS:**
    *   Ensure your `backend/app.py` is configured to use these certificates. The `app.run()` call should look like this:
        ```python
        app.run(debug=True, host='0.0.0.0', port=5000, ssl_context=('backend/certs/localhost.pem', 'backend/certs/localhost-key.pem'))
        ```
    *   Also, ensure your `YAHOO_REDIRECT_URI` and CORS origin in `backend/app.py` are set to `https://localhost:5000/api/yahoo/callback` and `https://localhost:5000` respectively.

4.  **Start Your Local Backend Server:**
    *   Open a terminal window.
    *   Navigate to the `backend` directory.
    *   Activate your virtual environment:
        ```bash
        source venv/bin/activate
        ```
    *   Start the Flask application:
        ```bash
        python app.py
        ```
        *Your backend should now be running on `https://localhost:5000`.*

5.  **Update the Yahoo App Callback URL (Manual Step):**
    *   Go to your application's page on the [Yahoo Developer Network](https://developer.yahoo.com/apps/).
    *   **Delete ALL existing redirect URIs** associated with this application.
    *   **Add ONLY** the following exact URL as a new redirect URI:
        ```
        https://localhost:5000/api/yahoo/callback
        ```
    *   Save the changes in your Yahoo app settings.

6.  **Restart Frontend and Browser:**
    *   Completely restart your frontend development server (e.g., `npm start` or `yarn start` from the `frontend` directory).
    *   Close and re-open your web browser (or use an incognito window).

This setup provides a stable and secure local development environment for OAuth, eliminating the need to constantly update URLs.
